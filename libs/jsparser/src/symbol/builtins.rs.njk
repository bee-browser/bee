// DO NOT EDIT THIS FILE BY HAND.
//
// This file was automagically generated with:
// template: {{ template }}

use super::Symbol;
use super::SymbolRegistry;

impl Symbol {
    {%- for symbol in data %}
    {%- if symbol.startsWith('##') %}
    pub const HIDDEN_{{ symbol | constantCase }}: Self = Self({{ loop.index }});
    {%- else %}
    {#- Use `upper` instead of `constantCase` so that 'NaN' is converted into 'NAN'. #}
    pub const {{ symbol | upper }}: Self = Self({{ loop.index }});
    {%- endif %}
    {%- endfor %}

    pub fn is_hidden(&self) -> bool {
        self.0 <= {{ data | select('startsWith', '##') | length }}
    }
}

impl SymbolRegistry {
    pub(super) fn register_builtin_symbols(&mut self) {
        {%- for symbol in data %}
        {%- if symbol.startsWith('##') %}
        self.register_builtin_symbol(Symbol::HIDDEN_{{ symbol | constantCase }}, "{{ symbol }}");
        {%- else %}
        self.register_builtin_symbol(Symbol::{{ symbol | upper }}, "{{ symbol }}");
        {%- endif %}
        {%- endfor %}
    }

    fn register_builtin_symbol(&mut self, symbol: Symbol, value: &str) {
        let utf16: Vec<u16> = value.encode_utf16().collect();
        let (index, inserted) = self.symbols.insert_full(utf16);
        debug_assert_eq!(Symbol(index as u32), symbol, "{value}");
        debug_assert!(inserted, "{value}");
    }
}
